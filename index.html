<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Калькулятор призовых</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="icon.png">
  <style>
    /* Ваши стили */
  </style>
</head>
<body>
  <div class="container">
    <h1>Калькулятор призовых</h1>
    <label for="league">Выберите лигу:</label>
    <select id="league">
      <option value="super">Супер лига</option>
      <option value="a">А лига</option>
      <option value="b">Б лига</option>
      <option value="c">С лига</option>
    </select>

    <label for="wins">Количество побед:</label>
    <input type="number" id="wins" placeholder="Введите количество побед" min="0" max="5" oninput="validateInput(this)">

    <label for="losses">Количество поражений:</label>
    <input type="number" id="losses" placeholder="Введите количество поражений" min="0" max="5" oninput="validateInput(this)">

    <label for="wonSets">Выигранные партии в поражениях:</label>
    <input type="number" id="wonSets" placeholder="Введите количество выигранных партий" min="0" oninput="validateInput(this)">

    <label for="place">Занятое место:</label>
    <select id="place">
      <option value="1">1 место</option>
      <option value="2">2 место</option>
      <option value="3">3 место</option>
      <option value="4">4 место</option>
    </select>

    <button onclick="calculatePrize()">Рассчитать призовые</button>

    <div class="result" id="result"></div>
    <div class="error" id="error"></div>

    <div class="footer">
      <p>Рассчитайте ваши призовые за турнир по настольному теннису!</p>
    </div>
  </div>

  <script>
    // Функция для проверки ввода
    function validateInput(input) {
      const value = input.value;
      if (isNaN(value) || value.includes('.')) {
        input.value = value.replace(/[^0-9]/g, ''); // Удаляем всё, кроме цифр
        document.getElementById('error').innerText = "Пожалуйста, вводите только цифры.";
      } else {
        document.getElementById('error').innerText = ""; // Очищаем сообщение об ошибке
      }
    }

    // Расценки для лиг
    const leagueRates = {
      super: { win: 1800, loss: 400, wonSet: 300, participation: 500 }, // Супер лига
      a: { win: 1500, loss: 400, wonSet: 200 },                         // А лига
      b: { win: 1100, loss: 200, wonSet: 150 },                         // Б лига
      c: { win: 900, loss: 100, wonSet: 100 }                           // С лига
    };

    // Призовые за места
    const placePrizes = {
      1: 1000,
      2: 600,
      3: 400,
      4: 0 // За 4 место нет доплаты
    };

    function calculatePrize() {
      const league = document.getElementById('league').value;
      const wins = parseInt(document.getElementById('wins').value) || 0;
      const losses = parseInt(document.getElementById('losses').value) || 0;
      const wonSets = parseInt(document.getElementById('wonSets').value) || 0;
      const place = document.getElementById('place').value;

      // Очистка предыдущих сообщений
      document.getElementById('error').innerText = "";
      document.getElementById('result').innerText = "";

      // Проверка на корректность введенных данных
      if (isNaN(wins) || isNaN(losses) || isNaN(wonSets)) {
        document.getElementById('error').innerText = "Пожалуйста, введите корректные числа.";
        return;
      }

      // Проверка на максимальное количество игр
      if (wins + losses > 5) {
        document.getElementById('error').innerText = "Ошибка: за турнир можно сыграть не более 5 игр.";
        return;
      }

      // Проверка на корректность выигранных партий
      const maxWonSets = losses * 3; // Максимум 3 выигранные партии за каждое поражение
      if (wonSets > maxWonSets) {
        document.getElementById('error').innerText = `Ошибка: количество выигранных партий не может превышать ${maxWonSets} (3 партии за каждое поражение).`;
        return;
      }

      // Расчет призовых за победы
      const winPrize = wins * leagueRates[league].win;

      // Расчет призовых за поражения
      const lossPrize = losses * leagueRates[league].loss; // Фиксированная сумма за каждое поражение
      const wonSetsPrize = wonSets * leagueRates[league].wonSet; // Доплата за выигранные партии

      // Призовые за место
      const placePrize = placePrizes[place];

      // Доплата за участие (только для Супер лиги)
      const participationPrize = league === 'super' ? leagueRates[league].participation : 0;

      // Общая сумма
      const totalPrize = winPrize + lossPrize + wonSetsPrize + placePrize + participationPrize;

      document.getElementById('result').innerText = `Ваши призовые: ${totalPrize.toFixed(2)} рублей`;
    }

    // Регистрируем сервисный worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then((registration) => {
          console.log('ServiceWorker зарегистрирован:', registration);
        })
        .catch((error) => {
          console.log('Ошибка регистрации ServiceWorker:', error);
        });
    }
  </script>
</body>
</html>