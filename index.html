<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#121212">
  <meta name="description" content="Калькулятор призовых для турниров по настольному теннису">
  <title>Калькулятор призовых</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="icon.png">
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #121212;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #e0e0e0;
      -webkit-tap-highlight-color: rgba(0,0,0,0); /* Убирает синее выделение при тапе на iOS */
    }

    .container {
      background-color: #1e1e1e;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 500px;
      text-align: center;
      animation: fadeIn 0.5s ease-out;
      transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
      color: #ffffff;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: #bbbbbb;
      padding: 5px 0;
    }

    select, input {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid #333333;
      border-radius: 5px;
      font-size: 1rem;
      box-sizing: border-box;
      background-color: #2d2d2d;
      color: #e0e0e0;
      touch-action: manipulation;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), border-color 0.3s ease;
    }

    select:focus, input:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
      transform: translateY(-2px);
    }

    select:hover, input:hover {
      border-color: #3498db;
    }

    .invalid {
      border-color: #e74c3c;
      box-shadow: 0 0 5px rgba(231, 76, 60, 0.5);
    }

    button {
      width: 100%;
      padding: 0.75rem;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      position: relative;
      overflow: hidden;
    }

    button:hover {
      background-color: #2980b9;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    button:active {
      background-color: #2573a7;
      transform: translateY(1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    button::after {
      content: '';
      display: block;
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      pointer-events: none;
      background-image: radial-gradient(circle, rgba(255, 255, 255, 0.3) 10%, transparent 10.01%);
      background-repeat: no-repeat;
      background-position: 50%;
      transform: scale(10, 10);
      opacity: 0;
      transition: transform 0.6s, opacity 0.6s;
    }

    button:active::after {
      transform: scale(0, 0);
      opacity: 0.3;
      transition: 0s;
    }

    .result {
      color: var(--result-color);
      margin-top: 1.5rem;
      font-size: 1.2rem;
      font-weight: bold;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
    }

    .result.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .error {
      color: var(--error-color);
      margin-top: 1.5rem;
      font-size: 1rem;
      font-weight: bold;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
    }

    .error:not(:empty) {
      opacity: 1;
      transform: translateY(0);
    }

    .footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #777777;
    }
	/* Новые стили для тем */
  :root {
    --bg-color: #121212;
    --container-bg: #1e1e1e;
    --text-color: #e0e0e0;
    --input-bg: #2d2d2d;
    --button-bg: #3498db;
    --button-hover: #2980b9;
    --result-color: #27ae60;
    --error-color: #e74c3c;
  }

  body {
    background-color: var(--bg-color);
    color: var(--text-color);
  }

  .container {
    background-color: var(--container-bg);
  }

  input, select {
    background-color: var(--input-bg);
    color: var(--text-color);
  }

  button {
    background-color: var(--button-bg);
  }

  button:hover {
    background-color: var(--button-hover);
  }

  .error {
    color: var(--error-color);
  }

  /* Пульсация при фокусе */
  input:focus, select:focus {
    animation: pulse 0.5s ease;
  }

  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.5);
    }
    100% {
      box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
    }
  }

  /* Плавное очищение полей */
  input, select {
    transition: all 0.3s ease;
  }

  /* Светлая тема */
  body.light {
    --bg-color: #f0f0f0;
    --container-bg: #ffffff;
    --text-color: #333333;
    --input-bg: #e0e0e0;
    --button-bg: #3498db;
    --button-hover: #2980b9;
    --result-color: #27ae60;
    --error-color: #e74c3c;
  }

  /* Адаптация для мобильных устройств */
  @media (max-width: 600px) {
    body {
      padding: 10px;
      height: auto;
      min-height: 100vh; /* Резервный вариант */
      min-height: calc(var(--vh, 1vh) * 100); /* Использование --vh переменной */
    }
    
    .container {
      padding: 1.5rem;
      max-width: 100%;
      margin: 10px;
      box-sizing: border-box;
    }
    
    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }
    
    select, input, button {
      padding: 0.6rem;
      font-size: 1rem;
      margin-bottom: 0.8rem;
    }
    
    label {
      font-size: 0.9rem;
      margin-bottom: 0.3rem;
    }
    
    /* Кнопки темы и языка в ряд */
    .button-row {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
    }
    
    .button-row button {
      flex: 1;
    }
  }
  
  /* Для очень малых экранов */
  @media (max-width: 350px) {
    .container {
      padding: 1rem;
    }
    
    h1 {
      font-size: 1.3rem;
    }
    
    select, input, button {
      padding: 0.5rem;
      font-size: 0.9rem;
    }
  }
  
  /* Ландшафтная ориентация на мобильных */
  @media (max-height: 500px) and (orientation: landscape) {
    body {
      height: auto;
      padding: 10px 0;
    }
    
    .container {
      padding: 1rem;
      margin: 0 auto;
    }
    
    h1 {
      margin-top: 0;
      margin-bottom: 0.5rem;
      font-size: 1.2rem;
    }
    
    .footer {
      margin-top: 1rem;
    }
  }
  
  /* Исправление для устройств с "челкой" (iPhone X и новее) */
  @supports (padding: max(0px)) {
    body {
      padding-left: max(0px, env(safe-area-inset-left));
      padding-right: max(0px, env(safe-area-inset-right));
      padding-top: max(0px, env(safe-area-inset-top));
      padding-bottom: max(0px, env(safe-area-inset-bottom));
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Плавные переходы для всех элементов */
  body, h1, label, select, input, button, .result, .error, .footer {
    transition: all 0.3s ease;
  }

  /* Анимация нажатия кнопок */
  button {
    width: 100%;
    padding: 0.75rem;
    background-color: var(--button-bg);
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    position: relative;
    overflow: hidden;
  }
  
  button:hover {
    background-color: var(--button-hover);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
  
  button:active {
    background-color: #2573a7;
    transform: translateY(1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  }
  
  /* Эффект волны при нажатии */
  button::after {
    content: '';
    display: block;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    background-image: radial-gradient(circle, rgba(255, 255, 255, 0.3) 10%, transparent 10.01%);
    background-repeat: no-repeat;
    background-position: 50%;
    transform: scale(10, 10);
    opacity: 0;
    transition: transform 0.6s, opacity 0.6s;
  }
  
  button:active::after {
    transform: scale(0, 0);
    opacity: 0.3;
    transition: 0s;
  }
  
  /* Улучшенная анимация для полей ввода */
  select, input {
    width: 100%;
    padding: 0.75rem;
    margin-bottom: 1rem;
    border: 1px solid #333333;
    border-radius: 5px;
    font-size: 1rem;
    box-sizing: border-box;
    background-color: var(--input-bg);
    color: var(--text-color);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), border-color 0.3s ease;
  }
  
  select:focus, input:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
    transform: translateY(-2px);
  }
  
  select:hover, input:hover {
    border-color: #3498db;
  }
  
  /* Анимация результата */
  .result {
    color: var(--result-color);
    margin-top: 1.5rem;
    font-size: 1.2rem;
    font-weight: bold;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.5s ease, transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
  }
  
  .result.visible {
    opacity: 1;
    transform: translateY(0);
  }
  
  /* Анимация ошибки */
  .error {
    color: var(--error-color);
    margin-top: 1.5rem;
    font-size: 1rem;
    font-weight: bold;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
  }
  
  .error:not(:empty) {
    opacity: 1;
    transform: translateY(0);
  }
  
  /* Анимация для смены темы */
  body {
    transition: background-color 0.5s ease;
  }
  
  .theme-transition * {
    transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease;
  }

  /* Эффект волны при нажатии */
  .ripple-effect {
    position: absolute;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    transform: scale(0);
    animation: ripple 0.6s linear;
    pointer-events: none;
  }
  
  @keyframes ripple {
    to {
      transform: scale(2.5);
      opacity: 0;
    }
  }

  /* Фоновые элементы */
  .background-elements {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
    pointer-events: none;
  }
  
  .bg-element {
    position: absolute;
    color: var(--text-color);
  }
  
  body.light .bg-element {
    color: #000;
  }
  
  .racket-1 {
    top: 10%;
    right: 15%;
    transform: rotate(45deg);
    animation: float 20s ease-in-out infinite, rotation 40s linear infinite;
  }
  
  .racket-2 {
    bottom: 15%;
    left: 10%;
    transform: rotate(-30deg);
    animation: float 25s ease-in-out infinite reverse, rotation 60s linear infinite reverse;
  }
  
  .ball-1 {
    top: 30%;
    left: 20%;
    animation: bounce 15s ease-in-out infinite;
  }
  
  .ball-2 {
    bottom: 25%;
    right: 25%;
    animation: bounce 12s ease-in-out infinite 2s;
  }
  
  .table {
    bottom: 10%;
    left: 50%;
    transform: translateX(-50%);
    transform-origin: center;
    animation: tableFloat 15s ease-in-out infinite;
  }
  
  @keyframes float {
    0%, 100% {
      transform: translate(0, 0) rotate(45deg);
    }
    25% {
      transform: translate(-15px, 15px) rotate(40deg);
    }
    50% {
      transform: translate(10px, 25px) rotate(50deg);
    }
    75% {
      transform: translate(15px, 10px) rotate(42deg);
    }
  }
  
  @keyframes rotation {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
  
  @keyframes bounce {
    0%, 100% {
      transform: translate(0, 0);
    }
    25% {
      transform: translate(30px, 20px);
    }
    50% {
      transform: translate(10px, 40px);
    }
    75% {
      transform: translate(-20px, 15px);
    }
  }
  
  @keyframes tableFloat {
    0%, 100% {
      transform: translateX(-50%) rotate(0deg);
    }
    50% {
      transform: translateX(-50%) rotate(1deg);
    }
  }
  
  /* Адаптация фоновых элементов для мобильных устройств */
  @media (max-width: 600px) {
    .racket-1 {
      top: 5%;
      right: 5%;
      width: 60px;
      height: 60px;
    }
    
    .racket-2 {
      bottom: 10%;
      left: 5%;
      width: 50px;
      height: 50px;
    }
    
    .table {
      bottom: 5%;
      width: 150px;
      height: 75px;
    }
  }
  
  /* Дополнительные улучшения для контейнера */
  .container {
    background-color: var(--container-bg);
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    width: 100%;
    max-width: 500px;
    text-align: center;
    position: relative;
    z-index: 1;
    animation: fadeIn 0.5s ease-out;
    transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
    backdrop-filter: blur(5px);
  }
  
  /* Светлая тема для фона */
  body.light .background-elements {
    opacity: 0.7;
  }
  </style>
</head>
<body>
  <!-- SVG элементы для фона -->
  <div class="background-elements">
    <!-- Ракетки и мячи для тенниса -->
    <svg class="bg-element racket-1" width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M30 15C30 7.5 35 2 45 2C55 2 60 10 60 20C60 35 45 50 30 65L20 55C35 40 50 25 50 15C50 10 47.5 7.5 45 7.5C42.5 7.5 40 10 40 15C40 20 35 25 30 30L25 25C25 25 30 20 30 15Z" fill="currentColor" opacity="0.1"/>
      <path d="M15 75L25 65L30 70L20 80L15 75Z" fill="currentColor" opacity="0.2"/>
    </svg>
    
    <svg class="bg-element racket-2" width="70" height="70" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M30 15C30 7.5 35 2 45 2C55 2 60 10 60 20C60 35 45 50 30 65L20 55C35 40 50 25 50 15C50 10 47.5 7.5 45 7.5C42.5 7.5 40 10 40 15C40 20 35 25 30 30L25 25C25 25 30 20 30 15Z" fill="currentColor" opacity="0.1"/>
      <path d="M15 75L25 65L30 70L20 80L15 75Z" fill="currentColor" opacity="0.2"/>
    </svg>
    
    <svg class="bg-element ball-1" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="10" cy="10" r="9" fill="currentColor" opacity="0.1"/>
      <path d="M14 10C14 12.2091 12.2091 14 10 14C7.79086 14 6 12.2091 6 10C6 7.79086 7.79086 6 10 6C12.2091 6 14 7.79086 14 10Z" fill="currentColor" opacity="0.1"/>
    </svg>
    
    <svg class="bg-element ball-2" width="15" height="15" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="10" cy="10" r="9" fill="currentColor" opacity="0.1"/>
      <path d="M14 10C14 12.2091 12.2091 14 10 14C7.79086 14 6 12.2091 6 10C6 7.79086 7.79086 6 10 6C12.2091 6 14 7.79086 14 10Z" fill="currentColor" opacity="0.1"/>
    </svg>
    
    <svg class="bg-element table" width="200" height="100" viewBox="0 0 200 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect x="5" y="30" width="190" height="60" rx="2" fill="currentColor" opacity="0.05"/>
      <line x1="100" y1="30" x2="100" y2="90" stroke="currentColor" stroke-width="2" opacity="0.1"/>
    </svg>
  </div>
  
  <div class="container">
    <div class="button-row">
      <button id="themeToggle" aria-label="Переключить тему">Светлая тема</button>
      <button id="langToggle">EN</button>
    </div>
    <h1>Калькулятор призовых</h1>
    <label for="league">Выберите лигу:</label>
    <select id="league" aria-label="Выберите лигу">
      <option value="super">Супер лига</option>
      <option value="a">А лига</option>
      <option value="b">Б лига</option>
      <option value="c">С лига</option>
    </select>

    <label for="wins">Количество побед:</label>
    <input type="number" id="wins" placeholder="Введите количество побед" min="0" max="5" inputmode="numeric" pattern="[0-5]">

    <label for="losses">Количество поражений:</label>
    <input type="number" id="losses" placeholder="Введите количество поражений" min="0" max="5" inputmode="numeric" pattern="[0-5]">

    <label for="wonSets">Выигранные партии в поражениях:</label>
    <input type="number" id="wonSets" placeholder="Введите количество выигранных партий" min="0" inputmode="numeric">

    <label for="place">Занятое место:</label>
    <select id="place">
      <option value="1">1 место</option>
      <option value="2">2 место</option>
      <option value="3">3 место</option>
      <option value="4">4 место</option>
    </select>

    <div class="button-row" style="margin-top: 15px;">
      <button id="calculateButton">Рассчитать</button>
      <button id="resetButton">Сбросить</button>
    </div>

    <div class="result" id="result" style="opacity: 1; transform: translateY(0); margin-top: 20px;"></div>
    <div class="error" id="error"></div>

    <div class="footer">
      <p>Рассчитайте ваши призовые за турнир по настольному теннису!</p>
    </div>
  </div>

  <script type="module">
    import { initUI } from './ui.js';
    import { calculatePrize } from './calculator.js';
    
    // Дождемся полной загрузки страницы
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOMContentLoaded событие запущено');
      
      // Инициализация UI
      initUI();
      
      // Добавляем дополнительный обработчик напрямую для кнопки расчета
      document.getElementById('calculateButton').addEventListener('click', function() {
        console.log('Кнопка расчета нажата напрямую');
        calculatePrize();
      });
      
      // Для отладки, выведем содержимое всех полей ввода
      console.log('Значения полей:', {
        league: document.getElementById('league').value,
        wins: document.getElementById('wins').value,
        losses: document.getElementById('losses').value,
        wonSets: document.getElementById('wonSets').value,
        place: document.getElementById('place').value
      });
    });
  </script>
</body>
</html>